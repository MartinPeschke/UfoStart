<%inherit file="../layout.html"/>
<%namespace file="hnc:forms/templates/baseform.html" name="baseform"/>
<%namespace file="../widgets.html" name="widgets"/>

<%def name="header_buttons()">
    <div class="pull-right">
        Company: <a href="${url('website_company', **vctxt.urlArgs)}">${vctxt.company.name}</a>
    </div>
</%def>


<%def name="content()">
    <div class="container">
        <div class="row">
            <div class="col col-lg-12">
                <h1 class="section-title">
                    <span class="brand-primary">${company.name}</span>
                </h1>
            </div>
        </div>
        <div class="row mar-top-1">
            <div class="col col-lg-3">
                ${self.companyMainInfo(company)}
            </div>
            <div class="col col-lg-6">
                ${html.nn(company.description)}
                <div class="mar-top-1">
                    ${self.teamMembers(company.Users)}
                </div>

                %if vctxt.canEditCompany:
                    ${self.build_forms(view.form, values, errors)}
                %endif

            </div>

            <div class="col col-lg-3">

            </div>
        </div>
    </div>
</%def>

<%def name="companyMainInfo(company)">
    <div class="box-title">
        Company Details
    </div>
    <div class="picture-header">
        ${widgets.company_logo(company)}
    </div>
    <div class="number-widget">
        <h6>Startup Value</h6>
        <div class="value">
            ${company.startupValue}
        </div>
    </div>
</%def>

<%def name="teamMembers(members)">
    <div class="box-title">
        Team Members
    </div>
    <div class="member-pile">
        %for member in members:
            <div class="single-team-member box-card">
                <div class="number-widget pull-right">
                    <h6>Startup Value</h6>
                    <div class="value">${company.startupValue}</div>
                </div>
                ${widgets.userPic(member)}
                <div class="right-box">
                    <a href="${vctxt.userURL(member.token)}"><strong>${ member.name }</strong></a>
                    <div class="text-muted">${html.nn(member.position)}</div>
                    <small class="headline">${html.nn(member.headline)}</small>
                </div>
            </div>

        %endfor
    </div>
</%def>

<%def name="build_forms(form, values, errors)">
    <div class="box-dark">
        <div class="box-content">
            <form class="${form.grid.form_classes}" id="${form.id}" method="POST">
                ${baseform.prelims(form)}
                ${form.fieldMap['name'].render(form.id, request, values.get(form.id), errors.get(form.id), view)|n}
                ${form.fieldMap['email'].render(form.id, request, values.get(form.id), errors.get(form.id), view)|n}
                ${form.fieldMap['role'].render(form.id, request, values.get(form.id), errors.get(form.id), view)|n}
                <button type="submit" class="btn btn-primary">Invite member</button>
            </form>
        </div>
    </div>
</%def>

<%def name="post_scripts()">
    <script>
        require(["tools/ajax"], function(ajax){
            $(".form-validated").each(function(idx, form){
                ajax.ifyForm({root: $(form)});
            })
        });
    </script>
</%def>
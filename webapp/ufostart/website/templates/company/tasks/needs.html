<%inherit file="../../layout.html"/>
<%namespace file="hnc:forms/templates/baseform.html" name="baseform"/>


<%def name="header_buttons()">
    <a href="#" class="btn btn-primary switchLibrary">Add a Need</a>
</%def>

<%def name="pageTitle()"><div class="page-header">Task Setup</div></%def>


<%def name="content()">
    <div id="round-need-setup-page">
        <div class="container">
            <div class="row">
                <div class="col col-lg-12">
                    <h1>${view.template.name} <span class="template-icon ${view.template.getStyleKey()}"></span></h1>
                </div>
            </div>
        </div>
        <div class="container tasks-used">
            <div class="row">
                ${self.buildForm(view.form, values.get(view.form.id), errors.get(view.form.id), btnClass='btn btn-primary col col-lg-12')}
            </div>
        </div>
        <div class="container task-library hide">
            <div class="row">
                ${self.buildLibrary(view.form)}
            </div>
        </div>
    </div>
</%def>



<%def name="buildLibrary(form)">
    %for category in CATEGORIES:
        <div class="col col-lg-3">
            <h5 class="box-title dark">${category.name}</h5>
            <div class="category-task-list box-shaded" data-entity-id="${category.name}">
            %for need in view.categorizedAllTasks.get(category.name, []):
                ${self.renderNeed(form.id, need, inLibrary = True)}
            %endfor
            </div>
        </div>
    %endfor
    <div class="col col-lg-4 col-offset-4 mar-top-2">
        <a href="#" class="btn btn-primary btn-block btn-humonguous addNeedsBtn"><span>Add Needs</span></a>
    </div>
</%def>

<%def name="buildForm(form, values, errors, btnClass='btn-primary')">
    <form class="${form.classes}" method="post" id="${form.id}">
        ${baseform.prelims(form)}

        %for category in CATEGORIES:
            <div class="col col-lg-3">
                <h5 class="box-title">${category.name}</h5>
                <div class="category-task-list box-shaded" data-entity-id="${category.name}">
                %for need in view.categorizedTasks.get(category.name, []):
                    ${self.renderNeed(form.id, need, False)}
                %endfor
                </div>
            </div>
        %endfor


        <div class="col col-lg-4 col-offset-4 mar-top-2">
            <button type="submit" class="btn btn-primary btn-block btn-humonguous"><span>Find Solutions</span></button>
            <p class="text-center">You have 90 days to finish the round</p>
        </div>
    </form>
</%def>

<%def name="renderNeed(prefix, need, inLibrary = False)">
<div class="single-need ${'in-use' if need._inUse else ''} ${'in-library' if inLibrary else ''}" data-entity-sort="${need.name}" data-entity-id="${need.key}">
    <div class="single-need-inner">
        <input type="hidden" name="${prefix}.needKey" value="${need.name}"/>
        <a class="add-remove-btn remove"><span>Ã—</span></a>
        <div class="need-title">${need.name}</div>
        <div class="need-description">Dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. </div>
    </div>
</div>
</%def>

<%def name="post_scripts()">
    <script>
        require(["views/company/round/needs"], function(View){
            new View({el: $("#round-need-setup-page")})
        })
    </script>
</%def>